function sortables_init(){if(document.getElementsByTagName)for(tbls=document.getElementsByTagName("table"),ti=0;ti<tbls.length;ti++)thisTbl=tbls[ti],-1!=(" "+thisTbl.className+" ").indexOf("sortable")&&thisTbl.id&&ts_makeSortable(thisTbl)}function ts_makeSortable(t){if(t.rows&&t.rows.length>0)var e=t.rows[0];if(e)for(var r=0;r<e.cells.length;r++){var s=e.cells[r],n=ts_getInnerText(s);s.innerHTML='<a href="#" class="sortheader" onclick="ts_resortTable(this, '+r+');return false;">'+n+'<span class="sortarrow">&nbsp;&nbsp;&nbsp;</span></a>'}}function ts_getInnerText(t){if("string"==typeof t)return t;if("undefined"==typeof t)return t;if(t.innerText)return t.innerText;for(var e="",r=t.childNodes,s=r.length,n=0;s>n;n++)switch(r[n].nodeType){case 1:e+=ts_getInnerText(r[n]);break;case 3:e+=r[n].nodeValue}return e}function ts_resortTable(t,e){TIMERSTART=(new Date).getTime();for(var r,s=0;s<t.childNodes.length;s++)t.childNodes[s].tagName&&"span"==t.childNodes[s].tagName.toLowerCase()&&(r=t.childNodes[s]);var n=(ts_getInnerText(r),t.parentNode),a=e||n.cellIndex,o=getParent(n,"TABLE");if(!(o.rows.length<=1)){var l=ts_getInnerText(o.rows[1].cells[a]);sortfn=ts_sort_caseinsensitive,l.match(/^\d\d[\/-]\d\d[\/-]\d\d\d\d$/)&&(sortfn=ts_sort_date),l.match(/^\d\d[\/-]\d\d[\/-]\d\d$/)&&(sortfn=ts_sort_date),l.match(/^[Â£$]/)&&(sortfn=ts_sort_currency),l.match(/^[\d\.]+$/)&&(sortfn=ts_sort_numeric),SORT_COLUMN_INDEX=a;var b=new Array,d=new Array;for(i=0;i<o.rows[0].length;i++)b[i]=o.rows[0][i];for(j=1;j<o.rows.length;j++)d[j-1]=o.rows[j];for(d.sort(sortfn),"down"==r.getAttribute("sortdir")?(ARROW="&nbsp;&nbsp;&uarr;",d.reverse(),r.setAttribute("sortdir","up")):(ARROW="&nbsp;&nbsp;&darr;",r.setAttribute("sortdir","down")),i=0;i<d.length;i++)(!d[i].className||d[i].className&&-1==d[i].className.indexOf("sortbottom"))&&o.tBodies[0].appendChild(d[i]);for(i=0;i<d.length;i++)d[i].className&&-1!=d[i].className.indexOf("sortbottom")&&o.tBodies[0].appendChild(d[i]);for(var _=document.getElementsByTagName("span"),s=0;s<_.length;s++)"sortarrow"==_[s].className&&getParent(_[s],"table")==getParent(t,"table")&&(_[s].innerHTML="&nbsp;&nbsp;&nbsp;");r.innerHTML=ARROW}}function getParent(t,e){return null==t?null:1==t.nodeType&&t.tagName.toLowerCase()==e.toLowerCase()?t:getParent(t.parentNode,e)}function ts_sort_date(t,e){return aa=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]),bb=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]),10==aa.length?dt1=aa.substr(6,4)+aa.substr(3,2)+aa.substr(0,2):(yr=aa.substr(6,2),parseInt(yr)<50?yr="20"+yr:yr="19"+yr,dt1=yr+aa.substr(3,2)+aa.substr(0,2)),10==bb.length?dt2=bb.substr(6,4)+bb.substr(3,2)+bb.substr(0,2):(yr=bb.substr(6,2),parseInt(yr)<50?yr="20"+yr:yr="19"+yr,dt2=yr+bb.substr(3,2)+bb.substr(0,2)),dt1==dt2?0:dt1<dt2?-1:1}function ts_sort_currency(t,e){return aa=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,""),bb=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]).replace(/[^0-9.]/g,""),parseFloat(aa)-parseFloat(bb)}function ts_sort_numeric(t,e){return aa=parseFloat(ts_getInnerText(t.cells[SORT_COLUMN_INDEX])),isNaN(aa)&&(aa=0),bb=parseFloat(ts_getInnerText(e.cells[SORT_COLUMN_INDEX])),isNaN(bb)&&(bb=0),aa-bb}function ts_sort_caseinsensitive(t,e){return aa=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]).toLowerCase(),bb=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]).toLowerCase(),aa==bb?0:aa<bb?-1:1}function ts_sort_default(t,e){return aa=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]),bb=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]),aa==bb?0:aa<bb?-1:1}function addEvent(t,e,r,s){if(t.addEventListener)return t.addEventListener(e,r,s),!0;if(t.attachEvent){var n=t.attachEvent("on"+e,r);return n}alert("Handler could not be removed")}addEvent(window,"load",sortables_init);var SORT_COLUMN_INDEX,TIMESTART;